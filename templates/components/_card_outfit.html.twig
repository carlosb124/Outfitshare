<div class="relative group break-inside-avoid mb-6">
    <div class="bg-white rounded-3xl overflow-hidden hover:shadow-xl transition-all duration-300 border border-gray-100">
        {# Collage de prendas #}
        <div class="h-64 flex gap-0.5 overflow-hidden relative bg-gray-100">
            {% set visiblePrendas = outfit.prendas|slice(0, 3) %}
            {% set count = outfit.prendas|length %}
            
            {% if count == 1 %}
                 <img src="{{ visiblePrendas[0].imagenUrl ?: asset('images/placeholder.png') }}" class="w-full h-full object-cover" alt="Outfit">
            {% elseif count == 2 %}
                 {% for p in visiblePrendas %}
                     <div class="w-1/2 h-full">
                         <img src="{{ p.imagenUrl ?: asset('images/placeholder.png') }}" class="w-full h-full object-cover" alt="Prenda">
                     </div>
                 {% endfor %}
            {% elseif count >= 3 %}
                 {# 1 Big Left, 2 Small Right #}
                 <div class="w-2/3 h-full">
                     <img src="{{ visiblePrendas[0].imagenUrl ?: asset('images/placeholder.png') }}" class="w-full h-full object-cover" alt="Main Item">
                 </div>
                 <div class="w-1/3 h-full flex flex-col gap-0.5">
                     <div class="h-1/2">
                         <img src="{{ visiblePrendas[1].imagenUrl ?: asset('images/placeholder.png') }}" class="w-full h-full object-cover" alt="Item 2">
                     </div>
                     <div class="h-1/2 relative">
                         {% if count > 3 %}
                             <div class="absolute inset-0 bg-black/50 text-white flex items-center justify-center text-xs font-bold z-10">
                                 +{{ count - 3 }}
                             </div>
                         {% endif %}
                         <img src="{{ visiblePrendas[2].imagenUrl ?: asset('images/placeholder.png') }}" class="w-full h-full object-cover" alt="Item 3">
                     </div>
                 </div>
            {% else %}
                 {# No prendas â€” placeholder #}
                 <div class="w-full h-full flex items-center justify-center text-gray-300">
                     <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                         <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                         <circle cx="8.5" cy="8.5" r="1.5"/>
                         <polyline points="21 15 16 10 5 21"/>
                     </svg>
                 </div>
            {% endif %}
            
            {# Degradado hover #}
            <a href="{{ path('app_outfit_show', {'id': outfit.id}) }}" class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></a>
        </div>

        {# Info #}
        <div class="p-4">
            <div class="flex justify-between items-start mb-2">
                <div>
                    <h6 class="font-bold text-dark-gray leading-tight mb-1 line-clamp-1">
                        {{ outfit.titulo }}
                    </h6>
                    <div class="flex items-center text-xs text-gray-400 font-medium">
                        <span class="w-5 h-5 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center mr-1.5 flex-shrink-0">
                            {% if outfit.user.profilePhotoUrl %}
                                <img src="{{ outfit.user.profilePhotoUrl }}" class="w-full h-full object-cover" alt="">
                            {% else %}
                                <span class="text-[10px] text-gray-500 font-bold">{{ outfit.user.name|first|upper }}</span>
                            {% endif %}
                        </span>
                        {{ outfit.user.name|default('Anonymous') }}
                    </div>
                </div>
                
                {# Like count #}
                <span class="text-xs text-gray-400 flex items-center gap-1">
                    <i class="bi bi-heart"></i> {{ outfit.likes|length }}
                </span>
            </div>
            
            {% if outfit.descripcion %}
                <p class="text-xs text-gray-400 line-clamp-2">
                    {{ outfit.descripcion }}
                </p>
            {% endif %}
        </div>
    </div>
</div>
