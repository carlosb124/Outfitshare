<div class="relative group break-inside-avoid mb-6">
    <div class="bg-white rounded-3xl overflow-hidden hover:shadow-xl transition-all duration-300 border border-gray-100">
        {# Collage Layout #}
        <div class="h-64 flex gap-0.5 overflow-hidden relative bg-gray-100">
            {% set visiblePrendas = outfit.prendas|slice(0, 3) %}
            {% set count = outfit.prendas|length %}
            
            {% if count == 1 %}
                 <img src="{{ asset(visiblePrendas[0].imagen ? 'uploads/images/' ~ visiblePrendas[0].imagen : 'images/placeholder.png') }}" class="w-full h-full object-cover" alt="Outfit">
            {% elseif count == 2 %}
                 {% for p in visiblePrendas %}
                     <div class="w-1/2 h-full">
                         <img src="{{ asset(p.imagen ? 'uploads/images/' ~ p.imagen : 'images/placeholder.png') }}" class="w-full h-full object-cover" alt="Prenda">
                     </div>
                 {% endfor %}
            {% else %}
                 {# 1 Big Left, 2 Small Right #}
                 <div class="w-2/3 h-full">
                     <img src="{{ asset(visiblePrendas[0].imagen ? 'uploads/images/' ~ visiblePrendas[0].imagen : 'images/placeholder.png') }}" class="w-full h-full object-cover" alt="Main Item">
                 </div>
                 <div class="w-1/3 h-full flex flex-col gap-0.5">
                     <div class="h-1/2">
                         <img src="{{ asset(visiblePrendas[1].imagen ? 'uploads/images/' ~ visiblePrendas[1].imagen : 'images/placeholder.png') }}" class="w-full h-full object-cover" alt="Item 2">
                     </div>
                     <div class="h-1/2 relative">
                         {% if count > 2 %}
                             {% if count > 3 %}
                                 <div class="absolute inset-0 bg-black/50 text-white flex items-center justify-center text-xs font-bold z-10">
                                     +{{ count - 3 }}
                                 </div>
                             {% endif %}
                             <img src="{{ asset(visiblePrendas[2].imagen ? 'uploads/images/' ~ visiblePrendas[2].imagen : 'images/placeholder.png') }}" class="w-full h-full object-cover" alt="Item 3">
                         {% endif %}
                     </div>
                 </div>
            {% endif %}
            
            {# Overlay Gradient #}
            <a href="{{ path('app_outfit_show', {'id': outfit.id}) }}" class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></a>
        </div>

        {# Info #}
        <div class="p-4">
            <div class="flex justify-between items-start mb-2">
                <div>
                    <h6 class="font-bold text-dark-gray leading-tight mb-1 line-clamp-1">
                        {{ outfit.titulo }}
                    </h6>
                    <div class="flex items-center text-xs text-gray-400 font-medium">
                        <span class="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center mr-1.5 text-[10px] text-gray-500 font-bold">
                            {{ outfit.user.name|first|upper }}
                        </span>
                        {{ outfit.user.name|default('Anonymous') }}
                    </div>
                </div>
                
                {# Like Button (Placeholder until refactored) #}
                <button class="text-gray-400 hover:text-red-500 transition-colors">
                    <i class="bi bi-heart"></i>
                </button>
            </div>
            
            {% if outfit.descripcion %}
                <p class="text-xs text-gray-400 line-clamp-2">
                    {{ outfit.descripcion }}
                </p>
            {% endif %}
        </div>
    </div>
</div>
