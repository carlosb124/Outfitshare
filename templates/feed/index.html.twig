{% extends 'base.html.twig' %}

{% block title %}OutfitShare - Descubre tu estilo{% endblock %}

{% block body %}
{# Filtros de categoría #}
<div class="flex overflow-x-auto pb-6 gap-2 mb-8 no-scrollbar scroll-smooth">
    {% set currentCat = currentCategory|default('Para Ti') %}
    
    <a href="{{ path('app_feed', {'category': 'Para Ti'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Para Ti' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Para Ti</a>
    <a href="{{ path('app_feed', {'category': 'Tendencias'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Tendencias' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Tendencias</a>
    <a href="{{ path('app_feed', {'category': 'Streetwear'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Streetwear' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Streetwear</a>
    <a href="{{ path('app_feed', {'category': 'Vintage'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Vintage' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Vintage</a>
    <a href="{{ path('app_feed', {'category': 'Formal'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Formal' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Formal</a>
    <a href="{{ path('app_feed', {'category': 'Accesorios'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Accesorios' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Accesorios</a>
    <a href="{{ path('app_feed', {'category': 'Verano 2026'}) }}" class="px-5 py-2.5 rounded-full font-bold whitespace-nowrap transition-all text-sm {{ currentCat == 'Verano 2026' ? 'bg-neon-lime text-black font-extrabold' : 'bg-white dark:bg-[#1A1A1A] text-gray-500 dark:text-white/70 hover:bg-gray-50 dark:hover:bg-[#242424] border border-gray-200 dark:border-white/[0.12]' }}">Verano 2026</a>
</div>

{# Perfiles encontrados (solo en búsqueda) #}
{% if currentSearch and users is defined and users|length > 0 %}
    <div class="mb-8">
        <h2 class="text-xl font-bold text-dark-gray dark:text-white mb-4">Perfiles Encontrados</h2>
        <div class="flex overflow-x-auto gap-4 pb-4 no-scrollbar scroll-smooth">
            {% for u in users %}
                <a href="{{ path('app_profile_show', {'id': u.id}) }}" class="flex flex-col items-center bg-white dark:bg-[#1A1A1A] border border-gray-200 dark:border-white/[0.12] rounded-2xl p-4 min-w-[140px] max-w-[160px] hover:shadow-lg dark:hover:bg-[#242424] transition-all flex-shrink-0 group">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full overflow-hidden bg-gray-100 dark:bg-zinc-800 border border-gray-200 dark:border-white/[0.05]">
                        {% if u.profilePhotoUrl %}
                            <img src="{{ u.profilePhotoUrl }}" alt="{{ u.name }}" class="w-full h-full object-cover">
                        {% else %}
                            <div class="w-full h-full flex items-center justify-center text-dark-gray dark:text-white font-bold text-xl">
                                {{ u.name|first|upper }}
                            </div>
                        {% endif %}
                    </div>
                    <h3 class="font-bold text-sm text-dark-gray dark:text-white text-center truncate w-full">{{ u.name }}</h3>
                    <p class="text-xs text-gray-500 dark:text-white/50 text-center truncate w-full">@{{ u.nickname }}</p>
                </a>
            {% endfor %}
        </div>
    </div>
{% endif %}

{# Feed de outfits #}
<div class="px-0 md:px-0">
    {% if outfits|length > 0 %}
        <div class="mb-4 text-center">
             <span class="text-xs font-bold uppercase tracking-wider text-gray-400 dark:text-white/30">
                 {% if currentSearch %}Looks Encontrados{% else %}Últimos looks{% endif %}
             </span>
        </div>
        
        <div class="columns-1 sm:columns-2 md:columns-3 lg:columns-4 xl:columns-5 gap-6 space-y-6">
            {% for outfit in outfits %}
                {% include 'components/_card_outfit.html.twig' with {'outfit': outfit} %}
            {% endfor %}
        </div>
    {% else %}
        {# ══════════════════════════════════════════
           EMPTY STATE — Redesigned per audit
           ══════════════════════════════════════════ #}
        <div class="flex flex-col items-center justify-center py-24 empty-state-enter" role="status" aria-label="No hay looks todavía">
            {# Icono animado #}
            <div class="w-20 h-20 bg-gray-100 dark:bg-[#1A1A1A] rounded-full flex items-center justify-center mb-6 empty-state-pulse">
                <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-gray-400 dark:text-white/40">
                    {# Hanger icon #}
                    <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7l7 5.2a2 2 0 0 1-1.2 3.6H5.2a2 2 0 0 1-1.2-3.6L11 7V5.73A2 2 0 0 1 12 2z"/>
                    <line x1="5" y1="15.8" x2="5" y2="20"/>
                    <line x1="19" y1="15.8" x2="19" y2="20"/>
                </svg>
            </div>

            {# Title — Playfair Display #}
            <h3 class="text-2xl font-bold text-dark-gray dark:text-[#F0F0F0] mb-3" style="font-family: 'Playfair Display', Georgia, serif;">
                Tu feed está a punto de llenarse.
            </h3>

            {# Description #}
            <p class="text-gray-500 dark:text-white/45 text-sm leading-relaxed max-w-xs text-center mb-8">
                Sube tu primera prenda y empieza a crear looks en segundos.
            </p>

            {# CTA — Black in light mode, green in dark mode #}
            <a href="{{ path('app_outfit_new') }}" 
               class="bg-neon-lime text-black px-8 py-3.5 rounded-full font-bold transition-all transform hover:-translate-y-0.5 hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-3 focus-visible:outline-neon-lime">
                Crear mi primer look
            </a>
        </div>

        {# Animaciones del estado vacío #}
        <style>
            @keyframes emptyStateFadeIn {
                from { opacity: 0; transform: translateY(16px); }
                to   { opacity: 1; transform: translateY(0); }
            }
            @keyframes emptyStatePulse {
                0%, 100% { transform: scale(1); }
                50%      { transform: scale(1.06); }
            }
            .empty-state-enter {
                animation: emptyStateFadeIn 400ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 150ms both;
            }
            .empty-state-pulse {
                animation: emptyStatePulse 3s ease-in-out infinite;
            }
            @media (prefers-reduced-motion: reduce) {
                .empty-state-enter { animation: none; opacity: 1; }
                .empty-state-pulse { animation: none; }
            }
        </style>
    {% endif %}
</div>
{% endblock %}
